package com.org.shoppingcart.rest.service.impl;

import java.util.ArrayList;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import com.org.shoppingcart.core.bean.Data;
import com.org.shoppingcart.core.bean.ProductDto;
import com.org.shoppingcart.core.entities.Products;
import com.org.shoppingcart.core.repository.ProductsRepository;
import com.org.shoppingcart.core.response.ProductResponse;
import com.org.shoppingcart.core.service.ShoppingCartService;

@Service
@Transactional(rollbackFor = Exception.class)
public class ShoppingCartServiceImpl implements ShoppingCartService {

	@Autowired
	private ProductsRepository productsRepository;

	@Autowired
	public ShoppingCartServiceImpl(ProductsRepository productsRepository) {
		super();
		this.productsRepository = productsRepository;
	}

	@Override
	public ProductResponse findAllProducts() {
		ProductResponse response = new ProductResponse();
		try {
			List<Products> productList = productsRepository.findAll();
			List<ProductDto> productDtoList = new ArrayList<>();
			Data data = new Data();
			ProductDto productDto = new ProductDto();
			for (Products product : productList) {
				productDto.setId(1);
				productDto.setName(product.getProductName());
				productDto.setDescription(product.getProductName());
				productDto.setPrice(product.getPrice());
				productDto.setQuantity(0);
				productDtoList.add(productDto);
			}
			data.setProductList(productDtoList);
			response.setData(data);
			response.setStatus("Success");
			response.setStatusCode(200);

		} catch (Exception e) {
			response.setStatus("Failed");
			response.setStatusCode(0);
		}
		return response;
	}

}
